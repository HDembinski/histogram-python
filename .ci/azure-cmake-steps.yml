steps:

- task: UsePythonVersion@0
  inputs:
    versionSpec: '$(python.version)'
    architecture: 'x64'

- script: |
    python -m pip install --upgrade pip
    python -m pip install --upgrade pytest
    python -m pip install numpy pytest-benchmark 'futures; python_version<"3.4"'
  displayName: 'Install dependencies'

- task: CMake@1
  inputs:
    cmakeArgs: .. -DCMAKE_BUILD_TYPE=Debug -DBOOST_HISTOGRAM_ERRORS=ON
  displayName: 'Configure'

- script: cmake --build . -j
  displayName: 'Build'
  workingDirectory: build

- script: ctest --output-on-failure -C Debug
  displayName: 'Test'
  workingDirectory: build

